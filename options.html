<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>point_down ‚Ä¢ Options</title>
    <style>
        body {
            font-family: system-ui, Arial, sans-serif;
            padding: 16px;
            max-width: 820px;
        }

        label {
            display: block;
            margin: 10px 0 4px;
            font-weight: 600;
        }

        input[type=text],
        input[type=password],
        input[type=time] {
            width: 100%;
            padding: 8px;
        }

        .row {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .row>div {
            flex: 1;
        }

        .token-col {
            position: relative;
        }

        .info-link {
            position: absolute;
            right: 0;
            top: 6px;
            line-height: 0;
        }

        .info-icon {
            width: 20px;
            height: 20px;
            display: block;
            cursor: pointer;
        }

        button {
            margin-top: 16px;
            padding: 10px 14px;
            cursor: pointer;
        }

        small {
            color: #666;
        }

        hr {
            margin: 22px 0;
            border: none;
            border-top: 1px solid #ddd;
        }

        .hint {
            color: #555;
            font-size: 13px;
        }

        /* sezione avancadas collassabile */
        #advancedSection {
            display: none; /* nascosta finch√© non si clicca */
        }

        .buttons {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-top: 12px;
        }

        fieldset {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px;
            margin-top: 12px;
        }

        fieldset legend {
            padding: 0 6px;
            font-weight: 600;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(160px, 1fr));
            gap: 8px 16px;
            align-items: center;
        }

        .status-grid label {
            margin: 0;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <h1>point_down ‚Ä¢ Options</h1>

    <label>Jira Base URL</label>
    <input id="baseUrl" type="text" placeholder="https://facilitygrid.atlassian.net" />

    <div class="row">
        <div>
            <label>Email</label>
            <input id="email" type="text" placeholder="nome@empresa.com" />
        </div>

        <div class="token-col">
            <label>API Token</label>
            <!-- Icona informativa ancorata a destra, non influisce sul flusso -->
            <a class="info-link" href="https://youtu.be/X1F5LfCuq6I" target="_blank" rel="noopener noreferrer"
                title="Guarda il video di aiuto">
                <img class="info-icon" src="icons/info.png" alt="Info" />
            </a>
            <input id="token" type="password" placeholder="Jira API Token" />
        </div>
    </div>

    <label>JQL (opcional, para filtrar os cards)</label>
    <input id="jql" type="text" placeholder='sprint in openSprints() AND assignee = currentUser()' />
    <small class="hint"></small>

    <hr />

    <h2>Agendamento do modal</h2>
    <label>Hora di√°ria para abrir automaticamente o modal</label>
    <input id="alarmTime" type="time" step="60" />
    <small class="hint">Ex.: 17:50. O modal ser√° aberto automaticamente todos os dias nesse hor√°rio (hora
        local).</small>

    <!-- üîª PRIMA era qui il blocco bottoni; lo spostiamo sotto la sezione Avan√ßadas -->

    <!-- Sezione AVANZATE (collassabile) -->
    <div id="advancedSection">
        <hr />
        <h2>Prefer√™ncias</h2>

        <label>
            <input type="checkbox" id="forceTestCard" />
            <span>Sim, quero que apare√ßa a card de teste! (FGC-9683)</span>
        </label>
        <small class="hint">Quando marcado, o Point Down sempre adiciona a card de teste FGC-9683 √† lista, mesmo que o
            seu JQL n√£o a traga.</small>

        <label style="margin-top:12px;">
            <input type="checkbox" id="enableQueueLock" />
            <span>Ativar fila/lock cooperativo (anti-concorr√™ncia) via Issue Property</span>
        </label>
        <small class="hint">Quando habilitado (recomendado), cada grava√ß√£o de SP usa um lock at√¥mico em Jira para evitar
            colis√µes entre usu√°rios.</small>

        <label style="margin-top:12px;">
            <input type="checkbox" id="enableWeekend" />
            <span>Ativar as notifica√ß√µes tamb√©m s√°bado e domingo por finalidade de test</span>
        </label>
        <small class="hint">Quando desabilitado, a abertura autom√°tica n√£o acontece nos fins de semana.
            Abertura manual continua poss√≠vel em qualquer dia.</small>

        <fieldset id="statusFiltersBox" style="margin-top:16px;">
            <legend>Filtros de Status (lista principal)</legend>
            <div class="status-grid">
                <label><input type="checkbox" id="st_todo" /> To Do</label>
                <label><input type="checkbox" id="st_inprogress" /> In Progress</label>
                <label><input type="checkbox" id="st_blocked" /> Blocked</label>
                <label><input type="checkbox" id="st_needreqs" /> Need Reqs</label>
                <label><input type="checkbox" id="st_done" /> Done</label>
            </div>
            <small class="hint">As sele√ß√µes acima sempre se somam ao seu JQL. Se nenhum status for selecionado, nenhuma
                card ser√° retornada.</small>
        </fieldset>
    </div>

    <!-- üîª Bottoni ora restano SEMPRE in fondo (sotto Avan√ßadas) -->
    <div class="buttons">
        <button id="saveBtn">Salvar</button>
        <button id="testBtn">Testar conex√£o</button>
        <button id="advancedBtn" aria-expanded="false">Avan√ßadas</button>
        <span id="status"></span>
    </div>

    <script type="module" src="options.js"></script>
</body>

</html>
